<abstract><heading>Abstract</heading>A modern networked economy brings with it inherent risks to the security and stability of that economy, much as any other before the advent of the Internet has. But the world of E-Enterprise presents a new and unseen threat - that of the hacker. Whether of malicious intent or otherwise, attempts to break the security of high-profile web sites and E-Businesses are rife, and it is both the duty and responsibility of an organisation to protect against them. This essay examines the electronic threats to one of the United Kingdom's biggest electronic retailers - Amazon.co.uk - using a number of published techniques to model these threats, their potential impacts, and proposes measures for preventing them or limiting the damage they cause. </abstract><heading>Introduction</heading>Amazon.co.uk has achieved almost unrivalled success as a purely-online retailer. The core value in Amazon's business is not the products that they sell - though these do generate a substantial revenue, but in the Marketplace (which allows users to buy and sell from each other) and, crucially, the licensing of Amazon's technical architecture and model to other organisations. It is the success of Amazon's architecture and model that has created huge value in others wishing to use it to sell their own products. The diagram below represents a simplified view of the Amazon.co.uk system, from a networking point of view. It is this view that will be used to model the threats to Amazon's business and this view that will be built upon in each stage of this project. <figure/>Each section of this document will elaborate on the threats facing Amazon through a number of techniques. <list>Identifying ComponentsListing and explaining components comprising the greater Amazon.co.uk web siteModelling ThreatsUsing the Microsoft Threat Modelling Process to expand upon threats to Amazon's businessRisk Assessment ReportRe-writing the threat template to include priorities and countermeasures</list><heading>Identifying Components</heading>The first step in examining the threats to the Amazon.co.uk web site is to observe and analyse its behaviour and interactions with the user - the first place a hacker or inquisitive person will look for potential holes in the interface that can be exploited. Through usage of the Amazon.co.uk website, and a full examination of its functionality, the core components providing that functionality can be deduced. The table below lists a name for each component that is inferred, and the text below describes the behaviour of that component and its purpose in achieving a business goal. <heading>Product catalogue browsing component</heading>Throughout the website the user has the ability to browse for a product by clicking on the tabs on the navigation bar to change product type (books, electronics, videos etc), and further narrow the enquiry through category (such as genre) displayed on the left-hand navigation area. The results of the enquiry are displayed with products in the chosen categories pulled from the database displayed as search results displayed in a page-by-page layout. <heading>Search component</heading>The Amazon.co.uk website gives the user the ability to search for a product by entering a term(s) into a text field and clicking the GO button. The ability is also provided to search within a particular 'shop' (section - see above) such as DVDs, CDs, or books, and a 'Power Search' option is also provided for books, allowing the user to specify many other criteria such as publication date or ISBN number. Results matching or partially matching corresponding fields of products in the database are displayed and formatted to the user, and can be viewed individually in greater detail. <heading>Shopping Basket component</heading>Users have the ability to add, remove, and change quantities of items in a virtual 'shopping basket'. These items are held indefinitely and the website uses Cookies to record which products are stored in the shopping basket for unregistered users, registered users have a shopping basket stored in their account records on the server side database, making the shopping basket accessible from any internet-connected device. Users have the ability to discard the contents of the shopping basket or proceed to purchase the items in it. <heading>Saved Items / 'Wish List' component</heading>An extension to the Shopping Basket component, users can click a button on a product page to 'Add to Wish List'. The product then appears under the Shopping Basket section but is not added to the cart, but the user has the option to move Wish List items to the regular Shopping Basket or to remove them at any point. This information is, again, stored server-side for registered users. <heading>Purchasing component / Registration component</heading>Possibly the most important function supporting the business, the buying component allows users to 'check-out' the items stored in their shopping basket by clicking the 'Proceed to Checkout' button. This walks the user through a number of steps, summarised below: Signing-in (existing users. This checks the database for a valid username/password using an encrypted secure HTTP (https) connection. New users are walked-through the process of entering personal, payment, and delivery details, and selecting a username (the user's email address) and password. Their details are stored as a new record on the customer database. Users are prompted to select a delivery address from a number of previously used addresses stored with their customer record. Similarly, users must select a credit/debit card from a list of prior cards used for payment. A new card may be added. A summary screen is shown, with all the items to be ordered, delivery type, costs and total. Gift certificates can be redeemed by entering the code on the certificate, which is checked against a database of gift certificate numbers, and appropriate balance deducted from the order. On clicking the 'Place Your Order' button, stock information is updated, order information passed to dispatch departments/order fulfilment personnel, and the user sent a confirmation email. <heading>Account Management component</heading>On the main navigation bar on each page is a hyperlink to take the user to the 'Your Account' section of the website. Clicking this button brings up, upon logging-in successfully, a page displaying information about the user that is held in the Amazon.co.uk customer database, and gives the user the option to change or update that data. Furthermore, open and past orders are available to view, and tracking features present the user with basic information about the current stage of processing their order has reached and an estimated shipping/arrival date, based on information logged in the order processing database. <heading>Customised homepage / 'Your Store' / Product Reviewing</heading>Returning, registered users of Amazon.co.uk, identified by logging-in or by cookies stored on their machine from a prior visit, are presented with a personalised front page to Amazon. This page includes a number of recommendations and new products targeted at the user displayed in a large, central format - these recommendations are made using server-side logic to determine related products in similar categories, based on information stored in the database about products the user has bought, searched for and viewed in the past. In addition, where another user of Amazon has bought the same product(s) as the user, other items they purchased in the same transaction are often listed on this front page. This clever data mining often achieves the goal of suggesting to the user products that another user with similar interests has bought, aiming to boots sales. By navigating to the more detailed 'Your Store' section, users are presented with a list of recommendations that can be ranked - each product can be stricken-off as already owned or 'not interested', and given up to five stars indicating the relevance/interest to the user of that particular recommendation. This scoring is updated in the database and new, more suitable recommendations are selected from the products based on the improved criteria and displayed instantly to the user. Users can also write reviews for products they have purchased in the past to inform others interested in a particular product - each review, along with associated ranking and credited by the username of the reviewer, is stored in the database cluster and appended to the product information page. <picture/><heading>Modelling Threats</heading>For the purposes of this report, it is assumed that the overview analysis revealing the gateway firewall, and the encryption of personal data using the signup, login, and purchasing process identified within the components described above, present the complete picture of the security measures in Amazon.co.uk's e-commerce web site. These security measures will now be securitised and dangers to Amazon's business activities will be described, measured and quantified using the Threat Modelling Process provided by the Microsoft Corporation [1]. This is to be accomplished through a number of phases, working through the Threat Modelling Process, and tabulated below. <heading>Amazon.co.uk's assets</heading>The first step for any corporation requiring security to protect their business is an assessment of the assets they wish to protect, and analysis of the value of those assets in order to determine the appropriate balance of cost and security depending on the cost to the business of a compromise to the security of a given asset. The following table lists the chief assets of Amazon.co.uk's business with a brief evaluation of their value to the business. <heading>Customer Database</heading>Amazon.co.uk holds a large volume of personal data about its customers on its customer database, including names, contact details, and credit/debit card details. These are not only extremely valuable to the individuals they belong to, but Amazon are mandated under the Data Protection Act 1988 to take appropriate measures to protect the security and integrity of this data. Compromise of this database could lead to heavy fines for negligence, and severely impacted sales due to shaken customer confidence in Amazon.co.uk <heading>Products Database</heading>The back-end of Amazon.co.uk contains, within the SQL database cluster, a good deal of data about each product, and associated reviews, rankings, stock data, prices and other statistics. This data is chiefly used to produce the online catalogue by inserting wrapping HTML around it to produce a dynamic and interactive product page of each item. Without this data, the website would be unable to function and disrupt the ability for users to browse, search and buy items. It is also critical that the accuracy of this data be protected, for instance ensuring prices and stock are correct to safeguard sales revenue and successful fulfilment of orders. <heading>Sales and Statistics data</heading>Amazon.co.uk maintain a large archive of data relating to sales statistics in the SQL cluster that is constantly being updated as transactions are processed through the web site. This data records product volumes sold, times and dates of sales, types of user that purchase particular items, and many other demographics. This data is important to the marketing strategies of the organisation and is mined to predict trends regarding sales and to make business decisions on products to stock, pricing, marketing, and many other areas in the sell space of the businesses' function, making this data, and the protection of it from unauthorised access or modification, very important. <heading>Back-end website application and code</heading>The Amazon.co.uk website is generated dynamically using a combination of server-side dynamic HTML and client-side JavaScript, using a custom DLL (programming library) containing the functions used by the Amazon.co.uk web application. This application, and all the code generating the pages of the Amazon website are patented, copyrighted works and are valuable to Amazon - theft of these could lead to trade secrets and technology secrets being leaked to competitors, and corruption or change of these files could lead to unexpected or undesirable behaviour of the website and subsequent disruption to transactions. <heading>Amazon.co.uk internal network and link to Internet</heading>The logic and programming governing the behaviour of the Amazon network is contained within its network hardware. Router and switch configurations, firewall rules and programming, server access, restrictions, and policies are all important and disruption or change to these could cause the operation of the internal network, or the connection to the internet (and thus customers) to be threatened. <heading>Architecture Overview</heading>With a model of the Amazon.co.uk website, produced through the earlier table of components that comprise the whole, the next step in the process is to identify the technologies in use by Amazon that underlay these components and allow them to function as intended. The following table shows a list of those technologies chiefly used by the web application and supporting infrastructure, and details of where they are employed. <table/><heading>Architecture Diagrams</heading>The second stage in the Microsoft Threat Modelling Process mandates the creation of one or more Architecture Overview diagrams. These diagrams 'describe the composition and structure of the application' [1] and graphically represent 'Trust Boundaries' - these are the realms in which one or more subsystem(s) may trust the authority of each other. Data received by a subsystem from outside of its trust boundary should be assumed to be harmful, malicious or incorrect. <figure/><figure/><heading>Identifying Threats</heading>The third step in the Threat Modelling process is to identify and document specific threats to the assets of Amazon.co.uk - from the point of view of the network, host and application - and target at exploiting weaknesses of the specific technologies identified earlier. The following table lists and describes each threat in turn, and categorises them using Microsoft's STRIDE methodology [7], into the following categories: Spoofing, Tampering, Repudiation, Information Disclosure, Denial-of-Service and Elevation of Privilege. Risk is calculated based upon the formula Risk = Probability * Damage Potential where Probability and Damage Potential are ranked on a scale of 1-10, where 1 is very unlikely/minimal damage and 10 is certainty/catastrophic damage. <table/><table/><table/><table/><table/><table/><heading>Threat Rating</heading>Each of the threats listed and tabulated above is given another dimension in the rating assigned to it for 'risk'. This is accomplished using the Microsoft DREAD threat rating model - where each of the following factors are examined for each security threat and impact rated as High (3), Medium (2), or  Low (1): Damage Potential, Reproducibility, Exploitability, Affected Users and Discoverability (hence the DREAD abbreviation). The table below shows each of the threats identified previously, along with an associated score for each component of the DREAD schema representing its impact (Low, Medium or High). The total overall threat rating is given by the sum of these individual ratings, and is translated into an overall Low (5-7 total score), Medium (8-11 total score) or High (12-15 total score). <table/><heading>Risk Assessment Report</heading>With the DREAD ratings determined in the previous section, each of the core threat-templates that have been described above have now been subjected to two factors of analysis to determine the risk and severity attached to each. As such, they can be re-written, as below, to incorporate the Threat ratings - and sorted to indicate the highest priority threat first, flowing down to the threat with the lowest priority. N.B. For the sake of brevity, Attack Techniques and Countermeasures have been excluded - please see earlier Threat Description Templates. <table/><table/><table/><table/><table/><table/>In accordance with the overview provided by the re-ordered, rated and priorities templates of the top threat templates, it is possible to provide (i) A description of the ten most critical threats facing Amazon.co.uk's business and (ii) Countermeasures recommended to defend against these threats. Ten of the chief threats facing Amazon.co.uk, and suggested countermeasures to those threats, are: <list><heading>Threat</heading>1 Eavesdropping (sniffing) on unsecured data transmission (customer details, etc.)2 Unauthorised access to Oracle database leading to damage/theft of data3 Poisoning SQL queries through bad validation/checking4 Denial of Service attack on Web Farm5 Virii/Trojan Horses/Worms6 Unauthorised Access7 Theft of customer account details & credit card fraud (repudiation)8 Repudiation - phishing websites masquerading as Amazon.co.uk9 Buffer overflows from attacks on open ports (e.g. Oracle ODBC port, Telnet, FTP, etc.)10 Malicious Scripts from user input (e.g. product reviews)</list><list><heading>Countermeasure</heading>1 Encrypting form data and cookie transactions, disabling option to pay using unsecured server2 Secure database access policy, lowest-possible privileges3 Validate ALL user input before allowing it to pass SQL query to Oracle database using client-side embedded scripts and server-side database rules and permissions, or use pre-constructed database queries executed remotely by database itself4 Router & firewall software to detect and combat dropped SYN (TCP Synchronise) packets and detect/filter trafficLarge bandwidth and web server redundancy to 'soak up' attacks5 Robust, high-speed virus scanning at all entry points (gateways such as main firewall), up-to-date patched systems6 Effective permissions on web server, high-strength password policy for router, firewall, and Linux system users7 Enforcement of strong password policy for customer accounts, encrypted credit card details, effective security policies (such as only delivering ordered goods to credit card registered address)8 Proper policies for ensuring customer can differentiate genuine website (site certificate authorities), authentication through third-party checking authorities with encrypted connections9 Closing ALL unnecessary ports, patching all servers to latest version regularly, including open ports on database servers10 Lock-down, validate and filter user input in all areas where long strings can be sent to web server (such as product reviews)</list>